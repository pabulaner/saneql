-- gives the wrong result?
customer_tpch
.join(orders_tpch.filter(o_orderdate >= '1994-01-01'::date && o_orderdate < '1995-01-01'::date), c_custkey=o_custkey)
.join(lineitem_tpch, l_orderkey=o_orderkey)
.join(supplier_tpch, l_suppkey=s_suppkey)
.join(nation_tpch, s_nationkey=n_nationkey)
.join(region_tpch.filter(r_name='ASIA'), n_regionkey=r_regionkey)
.groupby({n_name}, {revenue:=sum(l_extendedprice * (1 - l_discount))})
.orderby({revenue})
.project({n_name, revenue})

